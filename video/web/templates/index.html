{% extends "base.html" %}
{% block title %}Batch Video Upload & Inspector{% endblock %}

{% block body %}
<div class="container">

  <!-- Upload -------------------------------------------------------->
  <details class="glass-card" open>
    <summary>📹 Batch Video Upload</summary>
    <div class="card-body">
      <form id="uploadForm" class="upload-form">
        <div class="file-input-wrapper">
          <input type="file" name="files" multiple accept="video/*"
                 required class="file-input" id="fileInput" />
          <label for="fileInput" class="file-input-label" id="fileLabel">
            📁 Select Video Files
          </label>
        </div>

        <input type="text" name="batch"
               placeholder="Batch name (optional)" />

        <button type="submit" class="btn">🚀 Upload Batch</button>
      </form>

      <div id="result" class="result-area" style="display:none;"></div>
    </div>
  </details>

  <!-- Existing batches ---------------------------------------------->
  <details class="glass-card">
    <summary>📂 Existing Batches</summary>
    <div class="card-body">
      <button onclick="listBatches()" class="btn btn-secondary"
              style="margin-bottom:1rem;">🔄 Refresh Batch List</button>
      <div id="batches" class="loading">Loading batches…</div>
    </div>
  </details>

  <!-- Batch videos -------------------------------------------------->
  <details class="glass-card">
    <summary>🎬 Batch Videos</summary>
    <div class="card-body">
      <div id="videos" class="empty-state">
        Select a batch above to view its videos.
      </div>
    </div>
  </details>

  <!-- Motion extract ------------------------------------------------>
  <details class="glass-card">
    <summary>🎞️ Motion Extract</summary>
    <div class="card-body">
      <form id="motionForm" class="upload-form">
        <div class="file-input-wrapper">
          <input id="motionInput" type="file" name="video" accept="video/*" required
                 class="file-input">
          <label for="motionInput" class="file-input-label" id="motionLabel">
            📁 Select a Video File
          </label>
        </div>

        <button type="submit" class="btn">⚡ Run Motion Extract</button>
      </form>

      <div id="motionResult" class="result-area" style="display:none;"></div>
      <div id="frames" style="display:flex;flex-wrap:wrap;gap:.5rem;"></div>
    </div>
  </details>

  <!-- Live previews ------------------------------------------------->
  <details class="glass-card">
    <summary>📺 Live Previews</summary>
    <div class="card-body">
      <div class="grid-two">
        <div>
          <select class="capDev"></select>
          <img class="prevImg">
        </div>
        <div>
          <select class="capDev"></select>
          <img class="prevImg">
        </div>
      </div>

      <button id="startAll" class="btn-small">▶ Start both</button>
    </div>
  </details>

  <!-- Witness record ----------------------------------------------->
  <details class="glass-card">
    <summary>🛰️ Witness Record</summary>
    <div class="card-body">
      <button class="btn" onclick="startWitness()">⚡ Start 60-s take</button>
      <pre id="witResult" class="result-area" style="display:none;"></pre>
    </div>
  </details>

</div>
{% endblock %}