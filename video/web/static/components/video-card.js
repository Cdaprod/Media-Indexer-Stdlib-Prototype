/* video/web/static/components/video-card.js
 *
 * Usage  <video-card sha1="‚Ä¶"  title="clip.mp4"></video-card>
 *        Automatically fetches `/frames/<sha1>_<time>.jpg` generated by
 *        the Artifact pipeline and renders the two scene thumbs that
 *        come back in the `/cards` payload.
 */
class VideoCard extends HTMLElement {
  set data(d){ this.render(d); }

  render({ artifact, scenes, score }) {
    const box   = document.createElement('div');
    box.className = 'video-info';

    box.innerHTML = `
      <div class="video-title">${artifact.path.split('/').pop()}</div>
      <div class="video-detail">üìê ${artifact.width}&nbsp;√ó&nbsp;${artifact.height}</div>
      <div class="video-detail">‚è±Ô∏è ${(artifact.duration).toFixed(1)} s</div>
      ${score != null ? `<div class="video-detail">‚≠ê ${(score).toFixed(3)}</div>` : ''}
      <div class="thumb-strip">
        ${scenes.map(s =>
          `<img src="${s.url}"
                title="t=${s.time.toFixed(1)}"
                loading="lazy" />`).join('')}
      </div>
    `;
    this.replaceChildren(box);
  }
}
customElements.define('video-card', VideoCard);